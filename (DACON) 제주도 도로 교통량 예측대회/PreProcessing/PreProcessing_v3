{"cells":[{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9JZIT8sd_ttU","executionInfo":{"status":"ok","timestamp":1667643019320,"user_tz":-540,"elapsed":2498,"user":{"displayName":"정용한","userId":"17796726024763242388"}},"outputId":"03462b15-042c-4d5f-c91f-50832751a518"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}]},{"cell_type":"markdown","metadata":{"id":"WfWTfJo5WOvW"},"source":["## 라이브러리 정의 및 데이터 로드"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"i56hLkhfTnbR","executionInfo":{"status":"ok","timestamp":1667643019734,"user_tz":-540,"elapsed":420,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","from tqdm import tqdm\n","from sklearn.preprocessing import MinMaxScaler"]},{"cell_type":"code","source":["PATH = '/content/drive/MyDrive/AI_Contest/traffic/'"],"metadata":{"id":"mPPCdUki_0I1","executionInfo":{"status":"ok","timestamp":1667643019735,"user_tz":-540,"elapsed":3,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","execution_count":67,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8UGfz-VuTvSz","outputId":"d8fabc7b-f652-4e20-e2a3-668a401dd4da","executionInfo":{"status":"ok","timestamp":1667643297770,"user_tz":-540,"elapsed":3240,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["(4701217, 23)\n","(291241, 22)\n"]}],"source":["data_train = pd.read_parquet(PATH + 'datasets/data_train.parquet')\n","data_test = pd.read_parquet(PATH + 'datasets/data_test.parquet')\n","data_info = pd.read_csv(PATH + 'datasets/data_info.csv')\n","print(data_train.shape)\n","print(data_test.shape)\n","# data_train.head(1).transpose()"]},{"cell_type":"code","execution_count":68,"metadata":{"id":"lIBNlDLZFXmW","executionInfo":{"status":"ok","timestamp":1667643297771,"user_tz":-540,"elapsed":12,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data_test['target'] = np.zeros(len(data_test))"]},{"cell_type":"code","execution_count":69,"metadata":{"id":"XiCuzAxFTxQ4","executionInfo":{"status":"ok","timestamp":1667643298026,"user_tz":-540,"elapsed":266,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data_train.drop(['id'], axis=1, inplace=True)\n","data_test.drop(['id'], axis=1, inplace=True)"]},{"cell_type":"code","execution_count":70,"metadata":{"id":"69gYVXOOT4fl","executionInfo":{"status":"ok","timestamp":1667643298979,"user_tz":-540,"elapsed":956,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data = pd.concat([data_train, data_test], axis=0)\n","target = data_train['target']"]},{"cell_type":"markdown","metadata":{"id":"t-ROAbyNWSrI"},"source":["## 데이터 전처리"]},{"cell_type":"markdown","source":["전처리 세번째 version - road_name unique결과 \n","\n","train data안에 test data가 다 포함되어 있음을 확인 => LabelEncoding 시도"],"metadata":{"id":"l5rkZdlKB2Ts"}},{"cell_type":"markdown","metadata":{"id":"Gs_4QibunBwI"},"source":["#### road_name"]},{"cell_type":"code","execution_count":52,"metadata":{"id":"JhT92R1QnSan","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1667643054034,"user_tz":-540,"elapsed":409,"user":{"displayName":"정용한","userId":"17796726024763242388"}},"outputId":"ef71e840-f6aa-4e7f-ebb2-c72ae26b1ccd"},"outputs":[{"output_type":"stream","name":"stdout","text":["15\n","0\n"]}],"source":["print(len(set(data_train['road_name'].unique()) - set(data_test['road_name'].unique())))\n","print(len(set(data_test['road_name'].unique()) - set(data_train['road_name'].unique())))"]},{"cell_type":"markdown","source":["이름이 겹치는 도로들의 평균속도 확인\n","\n","비슷한 위치가 아니므로 해당 도로 특성 상 평균속도가 모두 다른 것을 알 수 있음\n","\n","=> 도로를 묵지 않고 레이블인코딩 시도"],"metadata":{"id":"nAlSt_7kLT5k"}},{"cell_type":"markdown","source":["##### check roads"],"metadata":{"id":"vsUc3uV4Otq3"}},{"cell_type":"code","source":["for i, v in enumerate(sorted(list(data_train['road_name'].unique()))):\n","  if i % 10 == 0:\n","    print(v, end=' ')\n","    print()\n","  else:\n","    print(v, end=' ')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rlLj91yTKLPq","executionInfo":{"status":"ok","timestamp":1667643054320,"user_tz":-540,"elapsed":4,"user":{"displayName":"정용한","userId":"17796726024763242388"}},"outputId":"76179f48-4492-47fc-d308-a2fb1384c561"},"execution_count":53,"outputs":[{"output_type":"stream","name":"stdout","text":["- \n","경찰로 고평교 관광단지1로 관광단지2로 관광단지로 관덕로 권학로 남조로 동문로 동부관광도로 \n","동홍로 번영로 산서로 삼무로 삼봉로 삼성로 새서귀로 서사로 수영장길 시민광장로 \n","시청로 신광로 신대로 신산로 아봉로 애원로 애조로 어시천교 연동로 연북2교 \n","연북로 연삼로 외도천교 일반국도11호선 일반국도12호선 일반국도16호선 일반국도95호선 일반국도99호선 일주동로 임항로 \n","제2거로교 중문로 중산간서로 중앙로 중정로 지방도1112호선 지방도1115호선 지방도1116호선 지방도1117호선 지방도1118호선 \n","지방도1119호선 지방도1120호선 지방도1132호선 지방도1136호선 지방도97호선 첨단로 태평로 한천로 호근로 호서중앙로 \n"]}]},{"cell_type":"code","source":["jibangs = ['지방도1112호선', '지방도1115호선', '지방도1116호선', '지방도1117호선', '지방도1118호선', \n","          '지방도1119호선', '지방도1120호선', '지방도1132호선', '지방도1136호선', '지방도97호선']\n","gwangwangs = ['관광단지1로', '관광단지2로', '관광단지로']\n","ilbans = ['일반국도11호선', '일반국도12호선', '일반국도16호선', '일반국도95호선', '일반국도99호선']"],"metadata":{"id":"XQ7F6bNHKU5n","executionInfo":{"status":"ok","timestamp":1667643054320,"user_tz":-540,"elapsed":2,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"execution_count":54,"outputs":[]},{"cell_type":"code","source":["sp_jibang = [[] for _ in range(10)]\n","for j, jibang in tqdm(enumerate(jibangs)):\n","  for i, v in enumerate(data_train['road_name']):\n","    if v == jibang:\n","      sp_jibang[j].append(data_train['target'][i])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"CQ7a0HPNMIzO","executionInfo":{"status":"ok","timestamp":1667643066838,"user_tz":-540,"elapsed":12520,"user":{"displayName":"정용한","userId":"17796726024763242388"}},"outputId":"cd795b35-916c-49f8-d48d-357246804ae3"},"execution_count":55,"outputs":[{"output_type":"stream","name":"stderr","text":["10it [00:12,  1.22s/it]\n"]}]},{"cell_type":"code","source":["for i in range(len(sp_jibang)):\n","  print(sum(sp_jibang[i]) / len(sp_jibang[i]))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"NJ0W5_kRNezT","executionInfo":{"status":"ok","timestamp":1667643066838,"user_tz":-540,"elapsed":10,"user":{"displayName":"정용한","userId":"17796726024763242388"}},"outputId":"793c1c67-ed0c-406c-abf7-32b4539ff47c"},"execution_count":56,"outputs":[{"output_type":"stream","name":"stdout","text":["47.29190913520321\n","53.75629606442617\n","61.58072063640618\n","58.903307594790824\n","50.635763382138315\n","41.875177765025825\n","36.228093113879915\n","40.370719866071425\n","45.92218584739361\n","60.52572257876038\n"]}]},{"cell_type":"code","source":["sp_gwangwang = [[] for _ in range(3)]\n","for j, gwangwang in tqdm(enumerate(gwangwangs)):\n","  for i, v in enumerate(data_train['road_name']):\n","    if v == gwangwang:\n","      sp_gwangwang[j].append(data_train['target'][i])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lO_NXipiN3tb","executionInfo":{"status":"ok","timestamp":1667643069757,"user_tz":-540,"elapsed":2927,"user":{"displayName":"정용한","userId":"17796726024763242388"}},"outputId":"268ca895-af2f-450b-8138-a0f23afd4c6e"},"execution_count":57,"outputs":[{"output_type":"stream","name":"stderr","text":["3it [00:02,  1.06it/s]\n"]}]},{"cell_type":"code","source":["for i in range(len(sp_gwangwang)):\n","  print(sum(sp_gwangwang[i]) / len(sp_gwangwang[i]))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"L1qC6SFlN4ek","executionInfo":{"status":"ok","timestamp":1667643069758,"user_tz":-540,"elapsed":13,"user":{"displayName":"정용한","userId":"17796726024763242388"}},"outputId":"0bebbb19-3522-4797-d33b-09c0129f7089"},"execution_count":58,"outputs":[{"output_type":"stream","name":"stdout","text":["39.29245283018868\n","34.46928698400158\n","30.307276345388477\n"]}]},{"cell_type":"code","source":["sp_ilban = [[] for _ in range(5)]\n","for j, ilban in tqdm(enumerate(ilbans)):\n","  for i, v in enumerate(data_train['road_name']):\n","    if v == ilban:\n","      sp_ilban[j].append(data_train['target'][i])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"xivAcAO3OD-p","executionInfo":{"status":"ok","timestamp":1667643085355,"user_tz":-540,"elapsed":15608,"user":{"displayName":"정용한","userId":"17796726024763242388"}},"outputId":"2592d777-11a4-40e8-ebda-1c22595f5a73"},"execution_count":59,"outputs":[{"output_type":"stream","name":"stderr","text":["5it [00:15,  3.13s/it]\n"]}]},{"cell_type":"code","source":["for i in range(len(sp_ilban)):\n","  print(sum(sp_ilban[i]) / len(sp_ilban[i]))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ExLPIH47OFF8","executionInfo":{"status":"ok","timestamp":1667643085355,"user_tz":-540,"elapsed":12,"user":{"displayName":"정용한","userId":"17796726024763242388"}},"outputId":"617995ea-6252-49cd-9105-74dcf698ea7e"},"execution_count":60,"outputs":[{"output_type":"stream","name":"stdout","text":["39.99015767196258\n","43.53097911082391\n","44.36514580440389\n","70.44343845822202\n","42.96566223689442\n"]}]},{"cell_type":"markdown","source":["##### labelEncoding"],"metadata":{"id":"eQp1-z0COyXi"}},{"cell_type":"code","source":["road_speed = data_train.groupby('road_name')['target'].agg('mean').sort_values(ascending=False)\n","print('변환전\\n', road_speed[:5])\n","\n","for i, a in enumerate(list(road_speed.index)):\n","    data_train.loc[data_train['road_name'] == a, 'road_name'] = i # 라벨 인코딩\n","    data_test.loc[data_test['road_name'] == a, 'road_name'] = i\n","road_speed = data_train.groupby('road_name')['target'].agg('mean').sort_values(ascending=False)\n","print('변환후\\n', road_speed[:5])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"taMQ6JYoO2_x","executionInfo":{"status":"ok","timestamp":1667643324618,"user_tz":-540,"elapsed":23693,"user":{"displayName":"정용한","userId":"17796726024763242388"}},"outputId":"fcdb473e-1485-4692-f3cf-0ff24c38092f"},"execution_count":71,"outputs":[{"output_type":"stream","name":"stdout","text":["변환전\n"," road_name\n","일반국도95호선     70.443438\n","지방도1116호선    61.580721\n","지방도97호선      60.525723\n","지방도1117호선    58.903308\n","애조로          57.212785\n","Name: target, dtype: float64\n","변환후\n"," road_name\n","0    70.443438\n","1    61.580721\n","2    60.525723\n","3    58.903308\n","4    57.212785\n","Name: target, dtype: float64\n"]}]},{"cell_type":"code","source":["data['road_name'] = pd.concat([data_train['road_name'], data_test['road_name']], axis=0)"],"metadata":{"id":"c1hZMrGxQE8c","executionInfo":{"status":"ok","timestamp":1667643325948,"user_tz":-540,"elapsed":424,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"execution_count":72,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"MUfgUMGUUKoG"},"source":["#### base_date"]},{"cell_type":"markdown","metadata":{"id":"LKcchrbFUMX4"},"source":["월 별로 고려 시 선형성을 띌 수 있기에 계절로 구분하여 OneHotEncoding"]},{"cell_type":"code","execution_count":73,"metadata":{"id":"ARk7UnkeUF1V","executionInfo":{"status":"ok","timestamp":1667643329206,"user_tz":-540,"elapsed":274,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["def change_date_to_season(x):\n","  month = int(str(x)[4:6])\n","  if 3 <= month <= 5:\n","    return \"spring\"\n","  elif 6 <= month <= 8:\n","    return \"summer\"\n","  elif 9 <= month <= 11:\n","    return \"autumn\"\n","  else:\n","    return \"winter\""]},{"cell_type":"code","execution_count":74,"metadata":{"id":"ENabiqfjUoFn","executionInfo":{"status":"ok","timestamp":1667643333148,"user_tz":-540,"elapsed":3533,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data['base_date'] = data['base_date'].apply(change_date_to_season)"]},{"cell_type":"code","execution_count":75,"metadata":{"id":"ie1czZYfRtbD","executionInfo":{"status":"ok","timestamp":1667643333554,"user_tz":-540,"elapsed":413,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["df_base_date1 = pd.get_dummies(data['base_date'])\n","df_base_date2 = df_base_date1[['spring', 'summer', 'autumn', 'winter']]"]},{"cell_type":"code","execution_count":76,"metadata":{"id":"MNFSPdeFRUqU","executionInfo":{"status":"ok","timestamp":1667643335235,"user_tz":-540,"elapsed":1683,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('base_date', axis=1, inplace=True)\n","data = pd.concat([data, df_base_date2], axis=1)"]},{"cell_type":"markdown","metadata":{"id":"G4uAOyLTWKb_"},"source":["#### day_of_week"]},{"cell_type":"markdown","metadata":{"id":"zl47kLtEWVZ6"},"source":["평일과 주말로 나누는 것으로 결정"]},{"cell_type":"code","execution_count":77,"metadata":{"id":"zGhucGp6NjIY","executionInfo":{"status":"ok","timestamp":1667643335235,"user_tz":-540,"elapsed":20,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["def change_week_to_str(x):\n","  if x in ['월', '화', '수', '목', '금']:\n","    return 'weekday'\n","  else:\n","    return 'weekend'"]},{"cell_type":"code","execution_count":78,"metadata":{"id":"dyHbgkCONyJj","executionInfo":{"status":"ok","timestamp":1667643336181,"user_tz":-540,"elapsed":961,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data['day_of_week'] = data['day_of_week'].apply(change_week_to_str)"]},{"cell_type":"code","execution_count":79,"metadata":{"id":"zBSqJSonN6GX","executionInfo":{"status":"ok","timestamp":1667643336691,"user_tz":-540,"elapsed":515,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["df_day_of_week = pd.get_dummies(data['day_of_week'])"]},{"cell_type":"code","execution_count":80,"metadata":{"id":"FBJrCHYFSc7C","executionInfo":{"status":"ok","timestamp":1667643337710,"user_tz":-540,"elapsed":1021,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('day_of_week', axis=1, inplace=True)\n","data = pd.concat([data, df_day_of_week], axis=1)"]},{"cell_type":"markdown","metadata":{"id":"vhMgrJ3iWZ8s"},"source":["#### base_hour"]},{"cell_type":"code","execution_count":81,"metadata":{"id":"PhI1LCPpV829","executionInfo":{"status":"ok","timestamp":1667643337710,"user_tz":-540,"elapsed":4,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["def change_time_to_slot(x):\n","  if 8 <= x <= 12:\n","    return \"time1\"\n","  elif 13 <= x <= 17:\n","    return \"time2\"\n","  elif 18 <= x <= 22:\n","    return \"time3\"\n","  else:\n","    return \"time4\""]},{"cell_type":"code","execution_count":82,"metadata":{"id":"VReiIqjzZqIt","executionInfo":{"status":"ok","timestamp":1667643338983,"user_tz":-540,"elapsed":1276,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data['base_hour'] = data['base_hour'].apply(change_time_to_slot)"]},{"cell_type":"code","execution_count":83,"metadata":{"id":"cTTy87b8S9T6","executionInfo":{"status":"ok","timestamp":1667643339389,"user_tz":-540,"elapsed":407,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["df_base_hour = pd.get_dummies(data['base_hour'])"]},{"cell_type":"code","execution_count":84,"metadata":{"id":"Bwldt8NaS7ja","executionInfo":{"status":"ok","timestamp":1667643340688,"user_tz":-540,"elapsed":1302,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('base_hour', axis=1, inplace=True)\n","data = pd.concat([data, df_base_hour], axis=1)"]},{"cell_type":"markdown","metadata":{"id":"bOTmIZWqXEmL"},"source":["#### lane_count"]},{"cell_type":"markdown","metadata":{"id":"cmwFeS24aOJA"},"source":["인코딩을 할 필요는 없어보임"]},{"cell_type":"markdown","metadata":{"id":"G67xaXH-a0Fb"},"source":["#### road_rating"]},{"cell_type":"code","execution_count":85,"metadata":{"id":"ljakn58wa2rA","executionInfo":{"status":"ok","timestamp":1667643340689,"user_tz":-540,"elapsed":4,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["df_road_rating = pd.get_dummies(data['road_rating'], prefix=\"rate\")"]},{"cell_type":"code","execution_count":86,"metadata":{"id":"zinxvUxmTJeK","executionInfo":{"status":"ok","timestamp":1667643341989,"user_tz":-540,"elapsed":1303,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('road_rating', axis=1, inplace=True)\n","data = pd.concat([data, df_road_rating], axis=1)"]},{"cell_type":"markdown","metadata":{"id":"N_W5VtdzcndG"},"source":["#### multi_linked"]},{"cell_type":"code","execution_count":87,"metadata":{"id":"vtjXSgLAcq_o","executionInfo":{"status":"ok","timestamp":1667643341990,"user_tz":-540,"elapsed":11,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["def change_int_to_char(x):\n","  if x == 0:\n","    return 'o'\n","  else:\n","    return 'x'"]},{"cell_type":"code","execution_count":88,"metadata":{"id":"RSKUdoCwc16N","executionInfo":{"status":"ok","timestamp":1667643342836,"user_tz":-540,"elapsed":855,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data['multi_linked'] = data['multi_linked'].apply(change_int_to_char)"]},{"cell_type":"code","execution_count":89,"metadata":{"id":"-rsdXK_PdDXw","executionInfo":{"status":"ok","timestamp":1667643342836,"user_tz":-540,"elapsed":4,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["df_multi_linked = pd.get_dummies(data['multi_linked'], prefix='multi')"]},{"cell_type":"code","execution_count":90,"metadata":{"id":"3tNrsmdjTQIu","executionInfo":{"status":"ok","timestamp":1667643344200,"user_tz":-540,"elapsed":1367,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('multi_linked', axis=1, inplace=True)\n","data = pd.concat([data, df_multi_linked], axis=1)"]},{"cell_type":"markdown","metadata":{"id":"jtcZJrP_dTKr"},"source":["#### connect_code"]},{"cell_type":"code","execution_count":91,"metadata":{"id":"kcVcEnYJdGvI","executionInfo":{"status":"ok","timestamp":1667643344200,"user_tz":-540,"elapsed":4,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["def change_int_to_char(x):\n","  if x == 0:\n","    return 'x'\n","  else:\n","    return 'o'"]},{"cell_type":"code","execution_count":92,"metadata":{"id":"DydDeBVVdYDa","executionInfo":{"status":"ok","timestamp":1667643345051,"user_tz":-540,"elapsed":854,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data['connect_code'] = data['connect_code'].apply(change_int_to_char)"]},{"cell_type":"code","execution_count":93,"metadata":{"id":"FMszXdoCdZ3y","executionInfo":{"status":"ok","timestamp":1667643345052,"user_tz":-540,"elapsed":4,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["df_connect_code = pd.get_dummies(data['connect_code'], prefix='connect')"]},{"cell_type":"code","execution_count":94,"metadata":{"id":"BsPajWIWTXNI","executionInfo":{"status":"ok","timestamp":1667643346406,"user_tz":-540,"elapsed":1357,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('connect_code', axis=1, inplace=True)\n","data = pd.concat([data, df_connect_code], axis=1)"]},{"cell_type":"markdown","metadata":{"id":"0EAfPYWF8iIH"},"source":["#### maximum_speed_limit"]},{"cell_type":"markdown","metadata":{"id":"iz5AqQ5YCVlP"},"source":["80대체를 생각해 보았으나 데이터 개수도 적고 잘못 기입될(이상치일) 확률이 적다고 판단되어 제거로 선택"]},{"cell_type":"code","execution_count":95,"metadata":{"id":"StV824UwAafS","executionInfo":{"status":"ok","timestamp":1667643346406,"user_tz":-540,"elapsed":4,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["# drop 시 런타임 에러가 떠서 dropna 사용\n","def change_40_to_nan(x):\n","  if x == 40:\n","    return np.nan\n","  else:\n","    return x"]},{"cell_type":"code","execution_count":96,"metadata":{"id":"nM271UJYKnw6","executionInfo":{"status":"ok","timestamp":1667643347803,"user_tz":-540,"elapsed":1401,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data['maximum_speed_limit'] = data['maximum_speed_limit'].apply(change_40_to_nan)"]},{"cell_type":"code","execution_count":97,"metadata":{"id":"VHrXTfSsKu-c","executionInfo":{"status":"ok","timestamp":1667643350258,"user_tz":-540,"elapsed":2460,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.dropna(axis=0, inplace=True)"]},{"cell_type":"code","execution_count":98,"metadata":{"id":"8r4ZBtCcDkvn","executionInfo":{"status":"ok","timestamp":1667643350259,"user_tz":-540,"elapsed":11,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data['maximum_speed_limit'] = data['maximum_speed_limit'].astype('int64')"]},{"cell_type":"code","execution_count":99,"metadata":{"id":"NQFmYDUKG_Rf","executionInfo":{"status":"ok","timestamp":1667643350663,"user_tz":-540,"elapsed":414,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["df_maximum_speed_limit = pd.get_dummies(data['maximum_speed_limit'], prefix='limit')"]},{"cell_type":"code","execution_count":100,"metadata":{"id":"f11Hdf07LxyL","executionInfo":{"status":"ok","timestamp":1667643351063,"user_tz":-540,"elapsed":402,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('maximum_speed_limit', axis=1, inplace=True)\n","data = pd.concat([data, df_maximum_speed_limit], axis=1)"]},{"cell_type":"markdown","metadata":{"id":"YottxjFd8n5s"},"source":["#### weight_restricted"]},{"cell_type":"code","execution_count":101,"metadata":{"id":"71Kd624XBPmh","executionInfo":{"status":"ok","timestamp":1667643351389,"user_tz":-540,"elapsed":334,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data['weight_restricted'] = data['weight_restricted'].astype('int64')\n","df_weight_restricted = pd.get_dummies(data['weight_restricted'], prefix='weight')"]},{"cell_type":"code","execution_count":102,"metadata":{"id":"jb7IZmmdTbX7","executionInfo":{"status":"ok","timestamp":1667643352627,"user_tz":-540,"elapsed":1241,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('weight_restricted', axis=1, inplace=True)\n","data = pd.concat([data, df_weight_restricted], axis=1)"]},{"cell_type":"markdown","metadata":{"id":"hZk60ZOP8rBP"},"source":["#### height_restricted"]},{"cell_type":"code","execution_count":103,"metadata":{"id":"j-j9d2njLc3z","executionInfo":{"status":"ok","timestamp":1667643353454,"user_tz":-540,"elapsed":839,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('height_restricted', axis=1, inplace=True)"]},{"cell_type":"markdown","metadata":{"id":"lNVWrz1-8s7m"},"source":["#### road_type"]},{"cell_type":"code","execution_count":104,"metadata":{"id":"CixKXZY4L8iQ","executionInfo":{"status":"ok","timestamp":1667643353454,"user_tz":-540,"elapsed":8,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["df_road_type = pd.get_dummies(data['road_type'], prefix='type')"]},{"cell_type":"code","execution_count":105,"metadata":{"id":"S20HEIliTfb0","executionInfo":{"status":"ok","timestamp":1667643354413,"user_tz":-540,"elapsed":966,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('road_type', axis=1, inplace=True)\n","data = pd.concat([data, df_road_type], axis=1)"]},{"cell_type":"markdown","metadata":{"id":"tgXzmSpam0V2"},"source":["#### start_latitude"]},{"cell_type":"code","execution_count":106,"metadata":{"id":"4qcUbHA5nITG","executionInfo":{"status":"ok","timestamp":1667643354413,"user_tz":-540,"elapsed":7,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["resh = np.array(data['start_latitude']).reshape(-1, 1)\n","\n","mms = MinMaxScaler()\n","mms.fit(resh[:-len(data_test)])\n","data['start_latitude'] = mms.transform(resh)"]},{"cell_type":"markdown","metadata":{"id":"lfB7snS8m3KB"},"source":["#### start_longitude"]},{"cell_type":"code","execution_count":107,"metadata":{"id":"qtJ7goXMnKNM","executionInfo":{"status":"ok","timestamp":1667643354414,"user_tz":-540,"elapsed":6,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["resh = np.array(data['start_longitude']).reshape(-1, 1)\n","\n","mms = MinMaxScaler()\n","mms.fit(resh[:-len(data_test)])\n","data['start_longitude'] = mms.transform(resh)"]},{"cell_type":"markdown","metadata":{"id":"A4m-bkJ88uG6","tags":[]},"source":["#### start_turn_restricted"]},{"cell_type":"code","execution_count":108,"metadata":{"id":"gaP6NhSqMf_9","executionInfo":{"status":"ok","timestamp":1667643354414,"user_tz":-540,"elapsed":5,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["def change_str_to_char(x):\n","  if x == '없음':\n","    return 'x'\n","  else:\n","    return 'o'"]},{"cell_type":"code","execution_count":109,"metadata":{"id":"mR3CQziqObdE","executionInfo":{"status":"ok","timestamp":1667643355253,"user_tz":-540,"elapsed":843,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data['start_turn_restricted'] = data['start_turn_restricted'].apply(change_str_to_char)"]},{"cell_type":"code","execution_count":110,"metadata":{"id":"X3JERN2uOm0E","executionInfo":{"status":"ok","timestamp":1667643355253,"user_tz":-540,"elapsed":5,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["df_start_turn_restricted = pd.get_dummies(data['start_turn_restricted'], prefix='start_turn_restricted')"]},{"cell_type":"code","execution_count":111,"metadata":{"id":"Xq0z2cyCTjUt","executionInfo":{"status":"ok","timestamp":1667643356624,"user_tz":-540,"elapsed":1376,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('start_turn_restricted', axis=1, inplace=True)\n","data = pd.concat([data, df_start_turn_restricted], axis=1)"]},{"cell_type":"markdown","metadata":{"id":"WLtvyLlvm8qu"},"source":["#### end_latitude"]},{"cell_type":"code","execution_count":112,"metadata":{"id":"P9ECNC7ynMJx","executionInfo":{"status":"ok","timestamp":1667643356625,"user_tz":-540,"elapsed":27,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["resh = np.array(data['end_latitude']).reshape(-1, 1)\n","\n","mms = MinMaxScaler()\n","mms.fit(resh[:-len(data_test)])\n","data['end_latitude'] = mms.transform(resh)"]},{"cell_type":"markdown","metadata":{"id":"YnAYn3Zqm-Zu"},"source":["#### end_longitude"]},{"cell_type":"code","execution_count":113,"metadata":{"id":"Eiff3zJ9nP_v","executionInfo":{"status":"ok","timestamp":1667643356626,"user_tz":-540,"elapsed":22,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["resh = np.array(data['end_longitude']).reshape(-1, 1)\n","\n","mms = MinMaxScaler()\n","mms.fit(resh[:-len(data_test)])\n","data['end_longitude'] = mms.transform(resh)"]},{"cell_type":"markdown","metadata":{"id":"kviwofiR8w_p"},"source":["#### end_turn_restricted"]},{"cell_type":"code","execution_count":114,"metadata":{"id":"BVyfCjdiO5TA","executionInfo":{"status":"ok","timestamp":1667643357462,"user_tz":-540,"elapsed":856,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data['end_turn_restricted'] = data['end_turn_restricted'].apply(change_str_to_char)"]},{"cell_type":"code","execution_count":115,"metadata":{"id":"bZfIgFRiO50S","executionInfo":{"status":"ok","timestamp":1667643357464,"user_tz":-540,"elapsed":14,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["df_end_turn_restricted = pd.get_dummies(data['end_turn_restricted'], prefix='end_turn_restricted')"]},{"cell_type":"code","execution_count":116,"metadata":{"id":"gD3t8oDHToRm","executionInfo":{"status":"ok","timestamp":1667643358533,"user_tz":-540,"elapsed":1082,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('end_turn_restricted', axis=1, inplace=True)\n","data = pd.concat([data, df_end_turn_restricted], axis=1)"]},{"cell_type":"markdown","metadata":{"id":"h_A6TAVpnDYc"},"source":["#### start_node_name"]},{"cell_type":"code","execution_count":117,"metadata":{"id":"6XuW1jcinTvW","executionInfo":{"status":"ok","timestamp":1667643358941,"user_tz":-540,"elapsed":414,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('start_node_name', axis=1, inplace=True)"]},{"cell_type":"markdown","metadata":{"id":"NRCuv2ZknEmk"},"source":["#### end_node_name"]},{"cell_type":"code","execution_count":118,"metadata":{"id":"xv8NHxTanWsA","executionInfo":{"status":"ok","timestamp":1667643359225,"user_tz":-540,"elapsed":286,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('end_node_name', axis=1, inplace=True)"]},{"cell_type":"markdown","metadata":{"id":"9n82Ov-Y8zdx"},"source":["#### vehicle_restricted"]},{"cell_type":"code","execution_count":119,"metadata":{"id":"iFTCDc58PGEQ","executionInfo":{"status":"ok","timestamp":1667643359598,"user_tz":-540,"elapsed":380,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["data.drop('vehicle_restricted', axis=1, inplace=True)"]},{"cell_type":"markdown","metadata":{"id":"qnJU47YeU_Gx"},"source":["## Data"]},{"cell_type":"code","execution_count":120,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":299},"id":"Dd0xriuFVKJF","outputId":"7de09f76-976e-4e53-cd1c-582b6239eb91","executionInfo":{"status":"ok","timestamp":1667643360206,"user_tz":-540,"elapsed":9,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["        lane_count road_name  start_latitude  start_longitude  end_latitude  \\\n","291236           1        15        0.733690         0.374722      0.726220   \n","291237           2        22        0.198072         0.556306      0.183479   \n","291238           1        46        0.800234         0.419808      0.812632   \n","291239           2        51        0.036304         0.433499      0.039110   \n","291240           3        21        0.011400         0.456675      0.011581   \n","\n","        end_longitude  target  spring  summer  autumn  ...  weight_0  \\\n","291236       0.371804     0.0       0       1       0  ...         1   \n","291237       0.558201     0.0       0       1       0  ...         1   \n","291238       0.420044     0.0       0       1       0  ...         1   \n","291239       0.433925     0.0       0       1       0  ...         1   \n","291240       0.455533     0.0       0       1       0  ...         1   \n","\n","        weight_32400  weight_43200  weight_50000  type_0  type_3  \\\n","291236             0             0             0       1       0   \n","291237             0             0             0       1       0   \n","291238             0             0             0       1       0   \n","291239             0             0             0       1       0   \n","291240             0             0             0       1       0   \n","\n","        start_turn_restricted_o  start_turn_restricted_x  \\\n","291236                        0                        1   \n","291237                        0                        1   \n","291238                        1                        0   \n","291239                        0                        1   \n","291240                        0                        1   \n","\n","        end_turn_restricted_o  end_turn_restricted_x  \n","291236                      0                      1  \n","291237                      0                      1  \n","291238                      1                      0  \n","291239                      0                      1  \n","291240                      0                      1  \n","\n","[5 rows x 39 columns]"],"text/html":["\n","  <div id=\"df-17f50524-241b-44e8-8c6f-d8e60fdf6351\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>lane_count</th>\n","      <th>road_name</th>\n","      <th>start_latitude</th>\n","      <th>start_longitude</th>\n","      <th>end_latitude</th>\n","      <th>end_longitude</th>\n","      <th>target</th>\n","      <th>spring</th>\n","      <th>summer</th>\n","      <th>autumn</th>\n","      <th>...</th>\n","      <th>weight_0</th>\n","      <th>weight_32400</th>\n","      <th>weight_43200</th>\n","      <th>weight_50000</th>\n","      <th>type_0</th>\n","      <th>type_3</th>\n","      <th>start_turn_restricted_o</th>\n","      <th>start_turn_restricted_x</th>\n","      <th>end_turn_restricted_o</th>\n","      <th>end_turn_restricted_x</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>291236</th>\n","      <td>1</td>\n","      <td>15</td>\n","      <td>0.733690</td>\n","      <td>0.374722</td>\n","      <td>0.726220</td>\n","      <td>0.371804</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>291237</th>\n","      <td>2</td>\n","      <td>22</td>\n","      <td>0.198072</td>\n","      <td>0.556306</td>\n","      <td>0.183479</td>\n","      <td>0.558201</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>291238</th>\n","      <td>1</td>\n","      <td>46</td>\n","      <td>0.800234</td>\n","      <td>0.419808</td>\n","      <td>0.812632</td>\n","      <td>0.420044</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>291239</th>\n","      <td>2</td>\n","      <td>51</td>\n","      <td>0.036304</td>\n","      <td>0.433499</td>\n","      <td>0.039110</td>\n","      <td>0.433925</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>291240</th>\n","      <td>3</td>\n","      <td>21</td>\n","      <td>0.011400</td>\n","      <td>0.456675</td>\n","      <td>0.011581</td>\n","      <td>0.455533</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 39 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-17f50524-241b-44e8-8c6f-d8e60fdf6351')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-17f50524-241b-44e8-8c6f-d8e60fdf6351 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-17f50524-241b-44e8-8c6f-d8e60fdf6351');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":120}],"source":["data.tail()"]},{"cell_type":"markdown","metadata":{"id":"sh1Pr9hAp4RQ"},"source":["## DataSet 분할 및 저장"]},{"cell_type":"code","execution_count":121,"metadata":{"id":"IgdMhgcbVLCd","executionInfo":{"status":"ok","timestamp":1667643398391,"user_tz":-540,"elapsed":775,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["train_df = data[:-len(data_test)].reset_index(drop=False).drop('index', axis=1)\n","test_df = data[-len(data_test):].reset_index(drop=False).drop('index', axis=1)\n","test_df.drop(['target'], axis=1, inplace=True)"]},{"cell_type":"code","execution_count":123,"metadata":{"id":"HiHyCBSifEjU","executionInfo":{"status":"ok","timestamp":1667643468313,"user_tz":-540,"elapsed":4027,"user":{"displayName":"정용한","userId":"17796726024763242388"}}},"outputs":[],"source":["train_df.to_parquet(PATH+\"datasets/train_v3.parquet\")\n","test_df.to_parquet(PATH+\"datasets/test_v3.parquet\")"]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":["MUfgUMGUUKoG","G4uAOyLTWKb_","vhMgrJ3iWZ8s","bOTmIZWqXEmL","G67xaXH-a0Fb","N_W5VtdzcndG","jtcZJrP_dTKr","0EAfPYWF8iIH","YottxjFd8n5s","hZk60ZOP8rBP"],"machine_shape":"hm","provenance":[{"file_id":"1RedVdMjKw0a4chlAnf_578bISstCibel","timestamp":1667640934239},{"file_id":"12QsS1PZghuevsz9NDDpEfOJ6yV2EAqCd","timestamp":1667638325131}]},"gpuClass":"premium","kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.13"},"vscode":{"interpreter":{"hash":"26de051ba29f2982a8de78e945f0abaf191376122a1563185a90213a26c5da77"}}},"nbformat":4,"nbformat_minor":0}